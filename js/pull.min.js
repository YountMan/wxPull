var pull={config:{elID:"",upMessageID:"",downMessageID:"",upPullToLoadMore:"上拉加载",upReleaseToRefresh:"松开加载",upRefreshing:"加载中…",upIsLastMessage:"已经是最后一页",downPullToRefresh:"下拉刷新",downReleaseToRefresh:"松开刷新",downRefreshing:"刷新中…",threshold:60,maxOffset:150,actionOffset:60,method:"up,down",upCallback:null,downCallback:null,totalRecords:0,pageSize:20},status:{hasTouch:"ontouchstart"in window,start:0,end:0,offset:0,direction:"",isLock:false,isCanMove:false,message:"",startScrollTop:0,page:1,isLast:false},isLastPage:function(){this.status.isLast=this.config.totalRecords<this.status.page*this.config.pageSize+1},init:function(t,s){if(typeof t=="object"){this.config=this.extend(this.config,t)}var e=document.querySelector(this.config.elID);var i=this;e.addEventListener("touchstart",function(t){i.touchStart(t)});e.addEventListener("touchmove",function(t){i.touchMove(t)});e.addEventListener("touchend",function(t){i.touchEnd(t)})},touchStart:function(t){this.setPositionOriginal();this.status.direction="";this.isLastPage();console.log("最后一页:"+this.status.isLast);this.status.isLock=true;this.status.isCanMove=true;var s=typeof event=="undefined"?t:event;this.status.start=this.status.hasTouch?s.touches[0].pageY:s.pageY;var e=document.querySelector(this.config.elID);var i=e.parentNode.scrollTop;this.status.startScrollTop=i},touchMove:function(t){var s=typeof event=="undefined"?t:event;this.status.end=this.status.hasTouch?s.touches[0].pageY:s.pageY;this.status.offset=this.status.end-this.status.start;var e=document.querySelector(this.config.elID);var i=e.parentNode;var o=i.scrollTop;this.setTransition(0);if(o>=0&&o<=e.clientHeight-i.clientHeight+1){i.scrollTop=i.scrollTop-this.status.offset}if(this.status.direction==""){this.status.direction=this.status.offset>0?"down":"up"}if(o==0&&this.status.direction=="down"){this.touchMoveDown()}if(o+1>=e.clientHeight-i.clientHeight&&this.status.direction=="up"){this.touchMoveUp()}},touchMoveUp:function(){var t=document.querySelector(this.config.elID);var s=t.clientHeight-t.parentNode.clientHeight;var e=-this.status.offset-(s-this.status.startScrollTop);if(this.status.isLast){this.status.message=this.config.upIsLastMessage;this.setMessage();if(e>this.config.threshold){var i=-e+this.config.threshold;if(-i>this.config.actionOffset){i=-this.config.actionOffset}this.setTransition(0);this.translate(i)}}else{this.status.message=this.config.upPullToLoadMore;this.setMessage();if(e>this.config.threshold){var i=-e+this.config.threshold;if(-i>this.config.actionOffset){this.status.message=this.config.upReleaseToRefresh;if(-i>this.config.maxOffset){i=-this.config.maxOffset}}this.setTransition(0);this.translate(i)}this.setMessage()}},touchMoveDown:function(){if(this.status.offset>this.config.threshold+this.status.startScrollTop){console.log("offset:"+this.status.offset);var t=this.status.offset-(this.config.threshold+this.status.startScrollTop);if(t>this.config.maxOffset)t=this.config.maxOffset;this.translate(t);this.status.message=this.config.downPullToRefresh;if(t>this.config.actionOffset){this.status.message=this.config.downReleaseToRefresh}this.setMessage()}},touchEnd:function(t){if(this.status.isCanMove){if(this.status.direction=="down"){this.touchEndDown()}if(this.status.direction=="up"){this.touchEndUp()}this.status.isCanMove=false;this.setTransition(1);this.back(0)}},touchEndDown:function(){var t=this.status.offset-(this.config.threshold+this.status.startScrollTop);if(t>this.config.actionOffset){this.status.message=this.config.downRefreshing;this.setMessage();if(typeof this.config.downCallback=="function"){this.config.downCallback()}}},touchEndUp:function(){var t=document.querySelector(this.config.elID);var s=t.clientHeight-t.parentNode.clientHeight;var e=-this.status.offset-(s-this.status.startScrollTop);if(e>this.config.threshold){if(!this.status.isLast){if(e>this.config.actionOffset+this.config.threshold){this.status.message=this.config.upRefreshing;this.setMessage();if(typeof this.config.upCallback=="function"){this.config.upCallback();this.status.page++}}}this.setTransition(1);this.back(0)}},setPositionOriginal:function(){var t=document.querySelector(this.config.elID);this.setTransition(0);var s=this.status.direction;if(s=="up"&&this.config.method.indexOf("up")>-1){var e=document.querySelector(this.config.upMessageID);e.className="";this.status.message=this.config.upPullToLoadMore;this.setMessage()}if(s=="down"&&this.config.method.indexOf("down")>-1){var e=document.querySelector(this.config.downMessageID);e.className="";this.status.message=this.config.downPullToRefresh;console.log("set message");this.setMessage()}},setTransition:function(t){var s=document.querySelector(this.config.elID);s.style.webkitTransition="all "+t+"s";s.style.transition="all "+t+"s";if(this.status.direction){var e=this.status.direction=="up"?this.config.upMessageID:this.config.downMessageID;e=document.querySelector(e);e.style.webkitTransition="all "+t+"s";e.style.transition="all "+t+"s"}},translate:function(t){var s=document.querySelector(this.config.elID);s.style.webkitTransform="translate(0,"+t+"px)";s.style.transform="translate(0,"+t+"px)";var e=this.status.direction=="up"?this.config.upMessageID:this.config.downMessageID;e=document.querySelector(e);e.style.height=Math.abs(t)+"px"},back:function(t){this.translate(0-t);this.status.isLock=false;this.status.isCanMove=false},setMessage:function(){if(this.status.direction=="up"){var t=document.querySelector(this.config.upMessageID);t.querySelector(".txt").innerText=this.status.message}if(this.status.direction=="down"){var t=document.querySelector(this.config.downMessageID);t.querySelector(".txt").innerText=this.status.message}},extend:function(){var t=arguments.length;var s=arguments[0]||{};if(typeof s!="object"&&typeof s!="function"){s={}}if(t==1){s=this}for(var e=1;e<t;e++){var i=arguments[e];for(var o in i){if(Object.prototype.hasOwnProperty.call(i,o)){s[o]=i[o]}}}return s}};